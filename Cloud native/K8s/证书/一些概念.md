### ä¸€ã€åè¯è§£é‡Š

***

* **[CAè¯ä¹¦](https://www.cnblogs.com/fps2tao/p/10036910.html)**

  *  CAè¯ä¹¦é¡¾åæ€ä¹‰å°±æ˜¯ç”±CAï¼ˆCertification Authorityï¼‰æœºæ„å‘å¸ƒçš„æ•°å­—è¯ä¹¦ã€‚

* **SSL/TLS**

  * [åŸç†](https://segmentfault.com/a/1190000002554673)ã€‚ã€ğŸŒŸå¿…çœ‹ã€‘
  * SSLï¼ˆsecurity sockets layerï¼Œå®‰å…¨å¥—æ¥å±‚ï¼‰æ˜¯ä¸ºç½‘ç»œé€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§çš„ä¸€ç§å®‰å…¨åè®®ã€‚SSL3.0ç‰ˆæœ¬ä»¥ååˆè¢«ç§°ä¸ºTLSã€‚
  * SSLä½äºTCPä¸å„åº”ç”¨å±‚ä¹‹é—´ï¼Œæ˜¯æ“ä½œç³»ç»Ÿå‘å¤–æä¾›çš„APIã€‚
  * åŠ å¯†ç®—æ³•
    * å¯¹ç§°åŠ å¯†
      * å¯¹ç§°åŠ å¯†å°±æ˜¯å‘é€åŒå‘ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ è§£å¯†ï¼Œå¸¸è§çš„å¯¹ç§°åŠ å¯†ä¸ºDESã€3DES,AESç­‰
    * éå¯¹ç§°åŠ å¯†
      * éå¯¹ç§°åŠ å¯†æ˜¯å‘é€åŒæ–¹å„è‡ªæ‹¥æœ‰ä¸€å¯¹å…¬é’¥ç§é’¥ï¼Œå…¶ä¸­å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œç§é’¥æ˜¯ä¿å¯†çš„ï¼ŒåŠ å¯†æ–¹æ³•æœ‰RSAã€Elgamalã€ECCç­‰

* **SSLå¦‚ä½•ä¿è¯ç½‘ç»œé€šä¿¡çš„å®‰å…¨å’Œæ•°æ®çš„å®Œæ•´æ€§å‘¢ï¼Ÿ**

  * èº«ä»½è®¤è¯ï¼šéœ€è¦ç”¨åˆ°CAè¯ä¹¦

    * è¯ä¹¦å†…å®¹ï¼š

      ```
      é¢å‘è€…
      ä½¿ç”¨è€…
      ç‰ˆæœ¬
      ç­¾åç®—æ³•
      ç­¾åå“ˆå¸Œç®—æ³•
      ä½¿ç”¨è€…
      å…¬é’¥
      æŒ‡çº¹
      æŒ‡çº¹ç®—æ³•
      ```

  * æ•°æ®åŠ å¯†

* **ç­¾å**

  * ç­¾ååœ¨ç½‘ç»œé€šè®¯ä¸­çš„åº”ç”¨ç§°ä¸ºæ•°å­—ç­¾å

* **è¯ä¹¦é“¾**
  * ä½¿ç”¨httpsåè®®è®¿é—®æ—¶ï¼ŒæœåŠ¡å™¨å‘é€è¯ä¹¦å‘æµè§ˆå™¨æ—¶ï¼Œé¦–å…ˆæŸ¥æ‰¾è¯¥è¯ä¹¦æ˜¯å¦å·²åœ¨ä¿¡ä»»åˆ—è¡¨ä¸­ï¼Œç„¶åå¯¹è¯ä¹¦è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸï¼Œé‚£ä¹ˆå°±è¯æ˜è¯ä¹¦æ˜¯å¯ä¿¡çš„ã€‚
  * è¯ä¹¦çš„è®¤è¯æ˜¯å®‰è£…è¯ä¹¦é“¾æ‰§è¡Œçš„ï¼Œè¯ä¹¦é“¾çš„æ„æ€æ˜¯æœ‰ä¸€ä¸ªè¯ä¹¦æœºæ„Aï¼ŒAç”Ÿæˆè¯ä¹¦Bï¼ŒBä¹Ÿå¯ä»¥ç”Ÿæˆè¯ä¹¦C
* **æ ¹è¯ä¹¦**
  * Aè¯ä¹¦å°±æ˜¯æ ¹è¯ä¹¦
  * æ ¹è¯ä¹¦åœ¨è¯ä¹¦éªŒè¯ä¸­æå…¶é‡è¦ï¼Œè€Œä¸”ï¼Œæ ¹è¯ä¹¦æ˜¯æ— æ¡ä»¶ä¿¡ä»»çš„ï¼Œåªè¦æˆ‘ä»¬å°†æ ¹è¯ä¹¦å®‰è£…ä¸Šï¼Œå°±è¯´æ˜æˆ‘ä»¬å¯¹æ ¹è¯ä¹¦æ˜¯ä¿¡ä»»çš„ã€‚æ¯”å¦‚æˆ‘ä»¬å®‰è£…12306çš„æ ¹è¯ä¹¦ï¼Œæ˜¯å‡ºäºæˆ‘ä»¬å¯¹å›½å®¶çš„ä¿¡ä»»ï¼Œå¯¹ç½‘ç«™çš„ä¿¡ä»»ï¼Œæˆ‘ä»¬æ‰æ”¾å¿ƒå®‰è£…è¿™ä¸ªæ ¹è¯ä¹¦ã€‚å¯¹äºä¸€äº›ä¸å®‰å…¨çš„ç½‘ç«™çš„è¯ä¹¦ï¼Œä¸€å®šè¦æ…é‡å®‰è£…ã€‚
* **è¯ä¹¦æœºæ„**
  * ã€å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„ã€‘ä¸­çš„è¯ä¹¦æ˜¯windowsé¢„å…ˆå®‰è£…çš„ä¸€äº›è¯ä¹¦ï¼Œéƒ½æ˜¯å›½é™…ä¸Šå¾ˆæœ‰æƒå¨çš„è¯ä¹¦æœºæ„ï¼Œä»–ä»¬è¯ä¹¦çš„ç”Ÿæˆéƒ½æœ‰å¾ˆä¸¥æ ¼çš„æµç¨‹ï¼Œå› æ­¤ä»–ä»¬çš„è¯ä¹¦è¢«è®¤ä¸ºæ˜¯å®‰å…¨

* **æœ‰å“ªäº›CAæœºæ„**
  * ä¸–ç•Œä¸Šè¾ƒæ—©çš„æ•°å­—è®¤è¯ä¸­å¿ƒæ˜¯ç¾å›½çš„verisignå…¬å¸ï¼Œåœ¨windowsçš„è¯ä¹¦çª—å£ä¸­å¯ä»¥çœ‹åˆ°å¥½å¤šverisignå…¬å¸ç”Ÿæˆçš„è¯ä¹¦
  * ä¸­å›½çš„å®‰å…¨è®¤è¯ä½“ç³»ï¼š
    * é‡‘èCAï¼šä¸­å›½äººæ°‘é“¶è¡Œç®¡ç†
    * éé‡‘èCAï¼šä¸­å›½ç”µä¿¡è´Ÿè´£
  * ä¸­å›½CAåˆå¯åˆ†ä¸º
    * è¡Œä¸šæ€§CAï¼šä¸­å›½é‡‘èè®¤è¯ä¸­å¿ƒå’Œä¸­å›½ç”µä¿¡è®¤è¯ä¸­å›½
    * åŒºåŸŸæ€§CAï¼šä»¥æ”¿åºœä¸ºèƒŒæ™¯ï¼Œä»¥ä¼ä¸šæœºåˆ¶è¿è¡Œï¼Œå…¶ä¸­å¹¿ä¸œCAä¸­å¿ƒå’Œä¸Šæµ·CAä¸­å½±å“æœ€å¤§

### äºŒã€è‡ªç­¾åè¯ä¹¦çš„å¦‚ä½•ç”Ÿæˆã€å®‰è£…

***

* æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨å†…éƒ¨ç³»ç»Ÿä¼ è¾“æ•°æ®éœ€è¦ä½¿ç”¨SSLåè®®ï¼Œå¯¹æ•°æ®åŠ å¯†ï¼Œä½†æ˜¯æˆ‘ä»¬åˆä¸æƒ³èŠ±é’±å»ç”³è¯·CAï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨è‡ªç­¾åCAï¼Œå®ç°æ•°æ®åŠ å¯†ä¼ è¾“çš„åŠŸèƒ½ã€‚
* é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹å°±æ˜¯è‡ªç­¾åè¯ä¹¦æ˜¯ä¸å®‰å…¨çš„ï¼Œå­˜åœ¨å®‰å…¨æ¼æ´

* [ä¸ºä»€ä¹ˆâ€è‡ªç­¾åSSLè¯ä¹¦â€ä¸å®‰å…¨ï¼Ÿ](https://www.cnblogs.com/liyy2015/p/7649837.html)
* [å¦‚ä½•åˆ©ç”¨keytoolå·¥å…·ç”Ÿæˆæ•°å­—è¯ä¹¦](https://jingyan.baidu.com/article/b0b63dbfe18eff4a483070f4.html)
* [æ·»åŠ è‡ªç­¾å‘çš„ SSL è¯ä¹¦ä¸ºå—ä¿¡ä»»çš„æ ¹è¯ä¹¦](https://cnzhx.net/blog/self-signed-certificate-as-trusted-root-ca-in-windows/)

### ä¸‰ã€è¯ä¹¦æ–‡ä»¶å’Œç”Ÿæˆ

***

* **x509è¯ä¹¦ä¸€èˆ¬ä¼šç”¨åˆ°ä¸‰ç±»æ–‡ï¼Œkeyï¼Œcsrï¼Œcrt**
  * **Key æ˜¯ç§ç”¨å¯†é’¥opensslæ ¼ï¼Œé€šå¸¸æ˜¯rsaç®—æ³•ã€‚**
  * **Csr æ˜¯è¯ä¹¦è¯·æ±‚æ–‡ä»¶ï¼Œç”¨äºç”³è¯·è¯ä¹¦ã€‚åœ¨åˆ¶ä½œcsræ–‡ä»¶çš„æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è‡ªå·±çš„ç§é’¥æ¥ç­¾ç½²ç”³ï¼Œè¿˜å¯ä»¥è®¾å®šä¸€ä¸ªå¯†é’¥ã€‚**
  * **crtæ˜¯CAè®¤è¯åçš„è¯ä¹¦æ–‡ï¼Œï¼ˆwindowsä¸‹é¢çš„ï¼Œå…¶å®æ˜¯crtï¼‰ï¼Œç­¾ç½²äººç”¨è‡ªå·±çš„keyç»™ä½ ç­¾ç½²çš„å‡­è¯ã€‚**

**1.keyçš„ç”Ÿæˆ** 

```bash
openssl genrsa -des3 -out server.key 2048
```

è¿™æ ·æ˜¯ç”Ÿæˆrsaç§é’¥ï¼Œdes3ç®—æ³•ï¼Œopensslæ ¼å¼ï¼Œ2048ä½å¼ºåº¦ã€‚server.keyæ˜¯å¯†é’¥æ–‡ä»¶åã€‚ä¸ºäº†ç”Ÿæˆè¿™æ ·çš„å¯†é’¥ï¼Œéœ€è¦ä¸€ä¸ªè‡³å°‘å››ä½çš„å¯†ç ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç”Ÿæˆæ²¡æœ‰å¯†ç çš„key:

```bash
openssl rsa -in server.key -out server.key
```

server.keyå°±æ˜¯æ²¡æœ‰å¯†ç çš„ç‰ˆæœ¬äº†ã€‚ 

**2. ç”ŸæˆCAçš„crt**

```bash
openssl req -new -x509 -key server.key -out ca.crt -days 3650
```

ç”Ÿæˆçš„ca.crtæ–‡ä»¶æ˜¯ç”¨æ¥ç­¾ç½²ä¸‹é¢çš„server.csræ–‡ä»¶ã€‚ 

**3. csrçš„ç”Ÿæˆæ–¹æ³•**

```bash
openssl req -new -key server.key -out server.csr
```

éœ€è¦ä¾æ¬¡è¾“å…¥å›½å®¶ï¼Œåœ°åŒºï¼Œç»„ç»‡ï¼Œemailã€‚æœ€é‡è¦çš„æ˜¯î€ƒæœ‰ä¸€ä¸ªcommon nameï¼Œå¯ä»¥å†™ä½ çš„åå­—æˆ–è€…åŸŸåã€‚å¦‚æœä¸ºäº†httpsç”³è¯·ï¼Œè¿™ä¸ªå¿…é¡»å’ŒåŸŸåå»åˆï¼Œå¦åˆ™ä¼šå¼•å‘æµè§ˆå™¨è­¦æŠ¥ã€‚ç”Ÿæˆçš„csræ–‡ä»¶äº¤ç»™CAç­¾ååå½¢æˆæœåŠ¡ç«¯è‡ªå·±çš„è¯ä¹¦ã€‚ 

**4. crtç”Ÿæˆæ–¹æ³•**

CSRæ–‡ä»¶å¿…é¡»æœ‰CAçš„ç­¾åæ‰å¯å½¢æˆè¯ä¹¦ï¼Œå¯å°†æ­¤æ–‡ä»¶å‘é€åˆ°verisignç­‰åœ°æ–¹ç”±å®ƒéªŒè¯ï¼Œè¦äº¤ä¸€å¤§ç¬”é’±ï¼Œä½•ä¸è‡ªå·±åšCAå‘¢ã€‚

```bash
openssl x509 -req -days 3650 -in server.csr -CA ca.crt -CAkey server.key -CAcreateserial -out server.crt
```

è¾“å…¥keyçš„å¯†é’¥åï¼Œå®Œæˆè¯ä¹¦ç”Ÿæˆã€‚-CAé€‰é¡¹æŒ‡æ˜ç”¨äºè¢«ç­¾åçš„csrè¯ä¹¦ï¼Œ-CAkeyé€‰é¡¹æŒ‡æ˜ç”¨äºç­¾åçš„å¯†é’¥ï¼Œ-CAserialæŒ‡æ˜åºåˆ—å·æ–‡ä»¶ï¼Œè€Œ-CAcreateserialæŒ‡æ˜æ–‡ä»¶ä¸å­˜åœ¨æ—¶è‡ªåŠ¨ç”Ÿæˆã€‚

æœ€åç”Ÿæˆäº†ç§ç”¨å¯†é’¥ï¼šserver.keyå’Œè‡ªå·±è®¤è¯çš„SSLè¯ä¹¦ï¼šserver.crt

è¯ä¹¦åˆå¹¶ï¼š

```bash
cat server.key server.crt > server.pem
```